(function(){function a(c,d,b){if(!c.addEventListener){c.attachEvent(d,b)}else{c.addEventListener(d,b,true)}}videojs.Dailymotion=videojs.MediaTechController.extend({init:function(f,d,e){videojs.MediaTechController.call(this,f,d,e);this.player_=f;this.playerEl_=this.player_.el();if(typeof this.player_.options().dmControls!=="undefined"){var h=this.player_.options().dmControls=parseInt(this.player_.options().dmControls)&&this.player_.controls();if(h&&this.player_.controls()){this.player_.controls(!h)}}if(typeof d.source!=="undefined"){for(var g in d.source){if(d.source.hasOwnProperty(g)){this.player_.options()[g]=d.source[g]}}}var i=this;this.bindedWaiting=function(){i.onWaiting()};this.player_.on("waiting",this.bindedWaiting);f.ready(function(){if(i.playOnReady&&!i.player_.options()["dmControls"]){if(typeof i.player_.loadingSpinner!=="undefined"){i.player_.loadingSpinner.show()}if(typeof i.player_.bigPlayButton!=="undefined"){i.player_.bigPlayButton.hide()}}f.trigger("loadstart")});this.videoId=this.parseSrc(this.player_.options().src);if(typeof this.videoId!=="undefined"){if(!this.player_.options().dmControls){if(typeof this.player_.poster()==="undefined"){this.player_.poster();setTimeout(function(){var k=i.playerEl_.querySelectorAll(".vjs-poster")[0];k.style.backgroundImage="url(https://api.dailymotion.com/video/"+i.videoId+"?fields=url&ads=false)";k.style.display="";k.style.backgroundSize="cover"},100)}}}this.id_=this.player_.id()+"_dailymotion_api";this.el_=videojs.Component.prototype.createEl("iframe",{id:this.id_,className:"vjs-tech",scrolling:"no",marginWidth:0,marginHeight:0,frameBorder:0,webkitAllowFullScreen:"",mozallowfullscreen:"",allowFullScreen:""});this.playerEl_.insertBefore(this.el_,this.playerEl_.firstChild);if(/MSIE (\d+\.\d+);/.test(navigator.userAgent)){var b=Number(RegExp.$1);this.addIframeBlocker(b)}else{if(!/(iPad|iPhone|iPod|Android)/g.test(navigator.userAgent)){this.el_.className+=" onDesktop";this.addIframeBlocker()}}this.params={id:this.id_,autoplay:(this.player_.options().autoplay)?1:0,chromeless:(this.player_.options().dmControls)?0:1,html:1,info:1,logo:1,controls:"html",wmode:"opaque",format:"json",url:this.player_.options().src};if(typeof this.params.list==="undefined"){delete this.params.list}if(this.player_.options().autoplay){this.player_.bigPlayButton.hide();this.playOnReady=true}if(window.location.protocol!=="file:"){this.params.origin=window.location.protocol+"//"+window.location.hostname}this.el_.src="http://www.dailymotion.com/services/oembed?"+videojs.Dailymotion.makeQueryString(this.params);if(videojs.Dailymotion.apiReady){this.loadApi()}else{videojs.Dailymotion.loadingQueue.push(this);if(!videojs.Dailymotion.apiLoading){var j=document.createElement("script");j.onerror=function(k){i.onError(k)};j.src="http://api.dmcdn.net/all.js";var c=document.getElementsByTagName("script")[0];c.parentNode.insertBefore(j,c);videojs.Dailymotion.apiLoading=true}}}});videojs.Dailymotion.prototype.params=[];videojs.Dailymotion.prototype.onWaiting=function(){if(typeof this.player_.bigPlayButton!=="undefined"){this.player_.bigPlayButton.hide()}};videojs.Dailymotion.prototype.addIframeBlocker=function(c){if(this.player_.options().dmControls){return false}this.iframeblocker=videojs.Component.prototype.createEl("div");this.iframeblocker.className="iframeblocker";this.iframeblocker.style.position="absolute";this.iframeblocker.style.left=0;this.iframeblocker.style.right=0;this.iframeblocker.style.top=0;this.iframeblocker.style.bottom=0;if(c&&c<9){this.iframeblocker.style.opacity=0.01}else{this.iframeblocker.style.background="rgba(255, 255, 255, 0.01)"}var b=this;a(this.iframeblocker,"mousemove",function(d){if(!b.player_.userActive()){b.player_.userActive(true)}d.stopPropagation();d.preventDefault()});a(this.iframeblocker,"click",function(){if(b.paused()){b.play()}else{b.pause()}});this.playerEl_.insertBefore(this.iframeblocker,this.el_.nextSibling)};videojs.Dailymotion.prototype.dispose=function(){if(this.dmPlayer){this.pause();for(var b=0;b<this.dmPlayer.listeners.length;b++){var d=this.dmPlayer.listeners[b];this.dmPlayer.removeEventListener(d.event,d.func)}this.dmPlayer=null}this.playerEl_.querySelectorAll(".vjs-poster")[0].style.backgroundImage="none";var c=document.getElementById(this.id_);if(c.parentNode){c.parentNode.removeChild(c)}if(typeof this.player_.loadingSpinner!=="undefined"){this.player_.loadingSpinner.hide()}if(typeof this.player_.bigPlayButton!=="undefined"){this.player_.bigPlayButton.hide()}videojs.MediaTechController.prototype.dispose.call(this)};videojs.Dailymotion.prototype.src=function(b){if(typeof b!=="undefined"){this.dmPlayer.load(this.parseSrc(b))}return this.srcVal};videojs.Dailymotion.prototype.currentSrc=function(){return this.srcVal};videojs.Dailymotion.prototype.play=function(){if(this.isReady_){this.dmPlayer.play()}else{this.playOnReady=true;if(!this.player_.options.dmControls){this.player_.bigPlayButton.show()}}};videojs.Dailymotion.prototype.ended=function(){if(this.isReady_){var b=this.dmPlayer.getPlayerState();return b===0}else{return false}};videojs.Dailymotion.prototype.pause=function(){this.dmPlayer.pause(!this.dmPlayer.paused)};videojs.Dailymotion.prototype.paused=function(){return this.dmPlayer.paused};videojs.Dailymotion.prototype.currentTime=function(){return(this.dmPlayer&&this.dmPlayer.currentTime)?this.dmPlayer.currentTime:0};videojs.Dailymotion.prototype.setCurrentTime=function(b){this.dmPlayer.seek(b,true);this.player_.trigger("timeupdate")};videojs.Dailymotion.prototype.duration=function(){return(this.dmPlayer&&this.dmPlayer.duration)?this.dmPlayer.duration:0};videojs.Dailymotion.prototype.buffered=function(){return[]};videojs.Dailymotion.prototype.volume=function(){if(isNaN(this.volumeVal)){this.volumeVal=this.dmPlayer.volume}return this.volumeVal};videojs.Dailymotion.prototype.setVolume=function(b){if(typeof(b)!=="undefined"&&b!==this.volumeVal){this.dmPlayer.setVolume(b);this.volumeVal=b;this.player_.trigger("volumechange")}};videojs.Dailymotion.prototype.muted=function(){return this.dmPlayer.muted};videojs.Dailymotion.prototype.setMuted=function(c){this.dmPlayer.setMuted(c);var b=this;setTimeout(function(){b.player_.trigger("volumechange")},50)};videojs.Dailymotion.prototype.onReady=function(){this.isReady_=true;this.player_.trigger("techready");this.triggerReady();this.player_.trigger("durationchange");if(this.playOnReady){this.dmPlayer.play()}};videojs.Dailymotion.isSupported=function(){return true};videojs.Dailymotion.prototype.supportsFullScreen=function(){return false};videojs.Dailymotion.canPlaySource=function(b){return(b.type==="video/dailymotion")};videojs.Dailymotion.loadingQueue=[];videojs.Dailymotion.prototype.load=function(){};videojs.Dailymotion.prototype.loadApi=function(){this.dmPlayer=new DM.player(this.id_,{video:this.videoId,width:this.options.width,height:this.options.height,params:this.params});this.setupTriggers();this.dmPlayer.vjsTech=this};videojs.Dailymotion.prototype.onStateChange=function(b){var c=b.type;if(c!==this.lastState){switch(c){case -1:this.player_.trigger("durationchange");break;case"apiready":this.onReady();break;case"ended":if(!this.player_.options().dmControls){this.player_.bigPlayButton.show()}break;case"play":this.player_.trigger("play");break;case"playing":break;case"pause":break;case"durationchange":break;case"timeupdate":this.player_.loadingSpinner.hide();break;case"progress":break}this.lastState=c}};videojs.Dailymotion.prototype.onError=function(b){this.player_.error(b);if(b===100||b===101||b===150){this.player_.bigPlayButton.hide();this.player_.loadingSpinner.hide();this.player_.posterImage.hide()}};videojs.Dailymotion.makeQueryString=function(b){var d=[];for(var c in b){if(b.hasOwnProperty(c)){d.push(encodeURIComponent(c)+"="+encodeURIComponent(b[c]))}}return d.join("&")};videojs.Dailymotion.prototype.parseSrc=function(d){this.srcVal=d;if(d){var c=/^.+dailymotion.com\/((video|hub)\/([^_]+))?[^#]*(#video=([^_&]+))?/;var b=d.match(c);return b?b[5]||b[3]:null}};videojs.Dailymotion.parsePlaylist=function(d){var c=/[?&]list=([^#\&\?]+)/;var b=d.match(c);if(b!==null&&b.length>1){return b[1]}};videojs.Dailymotion.prototype.setupTriggers=function(){this.dmPlayer.listeners=[];for(var b=videojs.Dailymotion.Events.length-1;b>=0;b--){var c=videojs.bind(this,this.eventHandler);this.dmPlayer.listeners.push({event:videojs.Dailymotion.Events[b],func:c});this.dmPlayer.addEventListener(videojs.Dailymotion.Events[b],c)}};videojs.Dailymotion.prototype.eventHandler=function(b){this.onStateChange(b);this.trigger(b)};videojs.Dailymotion.Events=("apiready,play,playing,pause,ended,canplay,canplaythrough,timeupdate,progress,seeking,seeked,volumechange,durationchange,fullscreenchange,error").split(",");window.dmAsyncInit=function(){var b;while((b=videojs.Dailymotion.loadingQueue.shift())){b.loadApi()}videojs.Dailymotion.loadingQueue=[];videojs.Dailymotion.apiReady=true}})();